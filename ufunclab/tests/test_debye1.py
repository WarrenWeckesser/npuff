import numpy as np
from numpy.testing import assert_allclose
from ufunclab import debye1


def test_debye1():
    x = np.linspace(-50, 50, 251)
    y = debye1(x)
    # yref was computed with mpmath. Specifically, the integral that
    # defines D1(x) was computed with mp.quad using mp.dps = 200.
    yref = [25.032898681336963, 24.833163993283232, 24.633433619244883,
            24.433707665304265, 24.233986241050584, 24.034269459726005,
            23.834557438379164, 23.634850298026446, 23.43514816382154,
            23.235451165233798, 23.035759436235832, 22.83607311550106,
            22.63639234661169, 22.43671727827786, 22.237048064568654,
            22.03738486515564, 21.837727845569916, 21.63807717747334,
            21.43843303894505, 21.238795614784156, 21.03916509682972,
            20.83954168429924, 20.639925584146802, 20.440317011442357,
            20.24071618977347, 20.041123351671207, 19.841538739061825,
            19.64196260374613, 19.442395207908458, 19.242836824657505,
            19.04328773860127, 18.84374824645873, 18.644218657710976,
            18.444699295294786, 18.245190496341984, 18.045692612968008,
            17.846206013113715, 17.646731081444553, 17.447268220311727,
            17.24781785078047, 17.04838041373083, 16.848956371037143,
            16.649546206832774, 16.450150428867317, 16.250769569964444,
            16.051404189588993, 15.85205487553315, 15.652722245732285,
            15.4534069502223, 15.254109673251522, 15.05483113556151,
            14.855572096852836, 14.656333358453491, 14.457115766209686,
            14.257920213620936, 14.058747645243864, 13.859599060391982,
            13.660475517161942, 13.461378136820313, 13.262308108589181,
            13.063266694873473, 12.864255236978337, 12.665275161371044,
            12.466327986548812, 12.26741533058219, 12.068538919412685,
            11.869700595994185, 11.670902330379956, 11.472146230871278,
            11.273434556360392, 11.074769730019657, 10.87615435451127,
            10.67759122891822, 10.479083367627808, 10.280634021435356,
            10.0822467011782, 9.883925204260494, 9.685673644488913,
            9.487496485710183, 9.28939857982578, 9.091385209859922,
            8.893462138877709, 8.695635665695361, 8.497912688499143,
            8.300300777700391, 8.102808259609384, 7.905444312820148,
            7.70821907957442, 7.511143794830684, 7.31423093632182,
            7.117494399565174, 6.920949702618325, 6.724614226385435,
            6.528507497510628, 6.3326515223911395, 6.137071182654307,
            5.941794704623656, 5.746854217907352, 5.5522864213293275,
            5.358133378028306, 5.164443465679946, 4.971272512403656,
            4.7786851538513835, 4.586756451937695, 4.395573820113356,
            4.205239303102215, 4.0158722591920935, 3.827612488364035,
            3.6406238367058905, 3.455098282508281, 3.271260466785022,
            3.089372564239322, 2.9097392930663677, 2.732712727755421,
            2.5586964065519147, 2.388148021297938, 2.221579763427064,
            2.0595552185706856, 1.9026816215908187, 1.7515963942322192,
            1.60694728460981, 1.469366176694076, 1.3394377225509146,
            1.21766522318744, 1.1044373526232936, 1.0, 0.9044373526232927,
            0.81766522318744, 0.7394377225509154, 0.6693661766940777,
            0.6069472846098101, 0.5515963942322191, 0.5026816215908192,
            0.45955521857068693, 0.42157976342706616, 0.38814802129793785,
            0.35869640655191504, 0.33271272775542227, 0.30973929306636927,
            0.28937256423932445, 0.2712604667850219, 0.25509828250828154,
            0.2406238367058918, 0.22761248836403655, 0.2158722591920962,
            0.20523930310221503, 0.1955738201133563, 0.18675645193769588,
            0.17868515385138586, 0.171272512403659, 0.16444346567994603,
            0.1581333780283065, 0.15228642132932899, 0.14685421790735362,
            0.14179470462365884, 0.1370711826543072, 0.1326515223911399,
            0.12850749751062862, 0.12461422638543644, 0.12094970261832427,
            0.11749439956517335, 0.11423093632182114, 0.11114379483068504,
            0.10821907957442174, 0.10544431282014737, 0.10280825960938449,
            0.10030077770039177, 0.09791268849914432, 0.09563566569536329,
            0.09346213887770831, 0.09138520985992273, 0.0893985798257819,
            0.08749648571018404, 0.0856736444889143, 0.0839252042604949,
            0.08224670117820002, 0.08063402143535728, 0.07908336762781064,
            0.07759122891822164, 0.07615435451127166, 0.07476973001965681,
            0.07343455636039325, 0.072146230871279, 0.07090233037995737,
            0.06970059599418617, 0.06853891941268511, 0.06741533058219126,
            0.066327986548814, 0.06527516137104443, 0.06425523697833924,
            0.06326669487347235, 0.062308108589181385, 0.06137813682031367,
            0.06047551716194233, 0.05959906039198278, 0.05874764524386338,
            0.057920213620936606, 0.05711576620968637, 0.05633335845349099,
            0.05557209685283629, 0.054831135561510855, 0.0541096732515216,
            0.05340695022230158, 0.05272224573228586, 0.05205487553315222,
            0.051404189588994016, 0.05076956996444267, 0.050150428867318096,
            0.04954620683277397, 0.04895637103714695, 0.04838041373082842,
            0.04781785078047051, 0.047268220311729836, 0.046731081444551355,
            0.04620601311371386, 0.04569261296800605, 0.04519049634198408,
            0.04469929529478864, 0.044218657710973754, 0.04374824645872937,
            0.04328773860126908, 0.04283682465750587, 0.042395207908459416,
            0.041962603746128216, 0.041538739061823884, 0.041123351671205656,
            0.04071618977347094, 0.040317011442358476, 0.039925584146801606,
            0.039541684299236206, 0.03916509682971968, 0.03879561478415628,
            0.03843303894505201, 0.03807717747333857, 0.037727845569913446,
            0.03738486515564151, 0.03704806456865374, 0.03671727827786219,
            0.03639234661168642, 0.03607311550105759, 0.035759436235831006,
            0.03545116523379798, 0.035148163821543295, 0.03485029802644547,
            0.03455743837916442, 0.03426945972600472, 0.033986241050583184,
            0.03370766530426693, 0.03343361924488265, 0.033163993283230365,
            0.03289868133696453]
    assert_allclose(y, yref, rtol=5e-15)
